<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>S32 SDK: Security Peripheral Abstraction Layer - SECURITY PAL</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top" style="height:auto; width:100%"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
  <img id="projectlogo" style="height:auto; width:100%" alt="Logo" src="s32sdk_logo_small.jpg"/>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__security__pal.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#groups">Modules</a>  </div>
  <div class="headertitle">
<div class="title">Security Peripheral Abstraction Layer - SECURITY PAL</div>  </div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>The SECURITY PAL provides security features over specific modules like:<br />
 -&gt; Cryptographic Services Engine (CSEc)<br />
 -&gt; Hardware Security Module (HSM)</p>
<h2>Features</h2>
<ul>
<li>Secure cryptographic key storage</li>
<li>AES-128 encryption and decryption</li>
<li>AES-128 CMAC (Cipher-based Message Authentication Code) calculation and authentication</li>
<li>ECB (Electronic Cypher Book) Mode - encryption and decryption</li>
<li>CBC (Cipher Block Chaining) Mode - encryption and decryption</li>
<li>True and Pseudo random number generation</li>
<li>Miyaguchi-Prenell compression function</li>
<li>Secure Boot Mode (user configurable)</li>
</ul>
<h2>How to use the SECURITY PAL in your application</h2>
<p>The SECURITY PAL is designed to be used in conjunction with CSEc driver or HSM driver, based on hardware platform. The SECURITY PAL can't be used simultaneously over different driver types.</p>
<p>The following table contains the matching between platforms and available IPs: </p><table class="doxtable">
<tr>
<th align="right">IP/MCU</th><th align="center">S32K116</th><th align="center">S32K118</th><th align="center">S32K142</th><th align="center">S32K144</th><th align="center">S32K142W</th><th align="center">S32K144W</th><th align="center">S32K146</th><th align="center">S32K148</th><th align="left">S32MTV </th><th align="left">MPC5746C</th><th align="left">MPC5748G  </th></tr>
<tr>
<td align="right">CSEC </td><td align="center">YES </td><td align="center">YES </td><td align="center">YES </td><td align="center">YES </td><td align="center">YES </td><td align="center">YES </td><td align="center">YES </td><td align="center">YES </td><td align="left">YES </td><td align="left">NO </td><td align="left">NO </td></tr>
<tr>
<td align="right">HSM </td><td align="center">NO </td><td align="center">NO </td><td align="center">NO </td><td align="center">NO </td><td align="center">NO </td><td align="center">NO </td><td align="center">NO </td><td align="center">NO </td><td align="left">NO </td><td align="left">YES </td><td align="left">YES </td></tr>
</table>
<p>The SECURITY PAL includes file security_pal_cfg.h, which allows the user to specify which IP is used and how many resources are allocated (state structure). The following code example shows how to configure one instance for one available security module.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#ifndef SECURITY_PAL_CFG_H</span></div>
<div class="line"><span class="preprocessor">#define SECURITY_PAL_CFG_H</span></div>
<div class="line"></div>
<div class="line"><span class="comment">/* Define which IP instance will be used in current project */</span></div>
<div class="line"><span class="preprocessor">#define SECURITY_OVER_CSEC</span></div>
<div class="line"><span class="preprocessor">#define NO_OF_CSEC_INSTS_FOR_SECURITY 1</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#endif </span><span class="comment">/* SECURITY_PAL_CFG_H */</span><span class="preprocessor"> </span></div>
</div><!-- fragment --><p>In order to use the SECURITY modules, the initialization procedure must be completed. Using the <a class="el" href="group__security__pal__driver.html#gab1ca032140efdb09e082391c8ff681ff" title="Initializes the SECURITY module. ">SECURITY_Init()</a> function, the instance of the module is selected and configured using the user configuration structure. </p>
<p>The security features are available in two types: blocking and non-blocking. The blocking features have specified in their naming the 'blocking' attribute. All other functions are considered to be non-blocking. The blocking functions use the osif layer, providing timeout feature. </p>
<pre class="fragment">## Important Notes ##    
</pre> <ul>
<li>For advanced usage, user must verify the specific drivers documentation for CSEc or HSM.</li>
<li>The SECURITY PAL enables the interrupts for the corresponding module. The application must configure the interrupts priorities.</li>
<li>The SECURITY PAL API offers a "timeout" parameter for a number of functions. If "timeout" value is set to value '0', the returned status shall not be assumed as "STATUS_TIMEOUT". This behaviour is given by the response time of the OS system tick and the execution time of the called function. Example: If OS system tick is set to 1ms, then the response time for a timeout set to '0', is between 0ms and 0.99ms. If the execution time of the functon is 10us, then there is a high probability that the returned status shall be "STATUS_SUCCESS". </li>
</ul>
<h2>Integration guideline</h2>
<h3>Compilation units</h3>
<p>The following files need to be compiled in the project: </p><pre class="fragment">${S32SDK_PATH}\platform\pal\src\security\security_pal.c
</pre><h3>Include path</h3>
<p>The following paths need to be added to the include path of the toolchain: </p><pre class="fragment">${S32SDK_PATH}\platform\drivers\inc
${S32SDK_PATH}\platform\pal\inc
${S32_SDK_PATH}\rtos\osif
</pre><h3>Compile symbols</h3>
<p>No special symbols are required for this component</p>
<h3>Dependencies</h3>
<p><a class="el" href="group__clock__manager.html">Clock Manager</a> <a class="el" href="group__interrupt__manager.html">Interrupt Manager (Interrupt)</a> <a class="el" href="group__osif.html">OS Interface (OSIF)</a> </p>
<pre class="fragment">## Example code ##
</pre> <div class="fragment"><div class="line"><span class="keyword">static</span> <a class="code" href="structsecurity__user__config__t.html">security_user_config_t</a> g_SecurityUserConfig;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> SecurityCallback(uint32_t completedCmd, <span class="keywordtype">void</span> *callbackParam)</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="group__security__pal__driver.html#ga71268e3c34bed302359cd8d4e8679010">security_cmd_t</a> securityCmd = (<a class="code" href="group__security__pal__driver.html#ga71268e3c34bed302359cd8d4e8679010">security_cmd_t</a>)completedCmd;</div>
<div class="line">    <span class="keywordflow">switch</span> (securityCmd)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="group__security__pal__driver.html#gga71268e3c34bed302359cd8d4e8679010aa7d61cc071ed3b2328ab38e09d89c293">SECURITY_CMD_ENC_ECB</a>:</div>
<div class="line">            <span class="comment">/* Do something... */</span></div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">default</span>:</div>
<div class="line">            <span class="comment">/* Error... */</span></div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line">    </div>
<div class="line"><span class="keywordtype">void</span> main()</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">static</span> <a class="code" href="status_8h.html#af9bff8ff1154a04a899276af806b8586">status_t</a> status = <a class="code" href="status_8h.html#af9bff8ff1154a04a899276af806b8586a83da0606125c0dc2fe0544cb2c383cb9">STATUS_SUCCESS</a>;</div>
<div class="line">    <span class="keyword">static</span> uint8_t rndBuf[16];</div>
<div class="line"></div>
<div class="line">    g_SecurityUserConfig.<a class="code" href="structsecurity__user__config__t.html#a8924dc849089cfa24deccee941ecf548">callback</a> = SecurityCallback;</div>
<div class="line"></div>
<div class="line">    status = <a class="code" href="group__security__pal__driver.html#gab1ca032140efdb09e082391c8ff681ff">SECURITY_Init</a>(<a class="code" href="group__security__pal__driver.html#gga4151ee0ba2bab4d3a27371fb15afe2f8aa208402f089a938d41c966eee32d9c13">SECURITY_INSTANCE0</a>, &amp;g_SecurityUserConfig);</div>
<div class="line">    <span class="keywordflow">if</span>(status != <a class="code" href="status_8h.html#af9bff8ff1154a04a899276af806b8586a83da0606125c0dc2fe0544cb2c383cb9">STATUS_SUCCESS</a>)</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">/* Error... */</span></div>
<div class="line">    }</div>
<div class="line">    status = <a class="code" href="group__security__pal__driver.html#gae21542888a1e2f7448c00c4a18aa4a65">SECURITY_InitRng</a>(<a class="code" href="group__security__pal__driver.html#gga4151ee0ba2bab4d3a27371fb15afe2f8aa208402f089a938d41c966eee32d9c13">SECURITY_INSTANCE0</a>, TIMEOUT);</div>
<div class="line">    <span class="keywordflow">if</span>(status != <a class="code" href="status_8h.html#af9bff8ff1154a04a899276af806b8586a83da0606125c0dc2fe0544cb2c383cb9">STATUS_SUCCESS</a>)</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">/* Error... */</span></div>
<div class="line">    }</div>
<div class="line">    status = <a class="code" href="group__security__pal__driver.html#gae7bc5ef8a1d8cdf6f953dc7040de3b7d">SECURITY_GenerateRnd</a>(<a class="code" href="group__security__pal__driver.html#gga4151ee0ba2bab4d3a27371fb15afe2f8aa208402f089a938d41c966eee32d9c13">SECURITY_INSTANCE0</a>, rndBuf, TIMEOUT);</div>
<div class="line">    <span class="keywordflow">if</span>(status != <a class="code" href="status_8h.html#af9bff8ff1154a04a899276af806b8586a83da0606125c0dc2fe0544cb2c383cb9">STATUS_SUCCESS</a>)</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">/* Error... */</span></div>
<div class="line">    }   </div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">while</span>(1);    </div>
<div class="line">}    </div>
</div><!-- fragment --> <table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="groups"></a>
Modules</h2></td></tr>
<tr class="memitem:group__security__pal__driver"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security__pal__driver.html">Security PAL</a></td></tr>
<tr class="memdesc:group__security__pal__driver"><td class="mdescLeft">&#160;</td><td class="mdescRight">Security Peripheral Abstraction Layer. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Fri Jun 11 2021 08:16:08 for S32 SDK by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.10 </li>
  </ul>
</div>
</body>
</html>
